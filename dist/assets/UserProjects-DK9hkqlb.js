import{w as I,g as B,j as e,b as H,e as V,p as x,aZ as O,a_ as R,B as o,a$ as $,b0 as G,b1 as j,b2 as U,_ as y,aT as q,av as z,a4 as p,b3 as J,b4 as Q,b5 as Z,b6 as K,b7 as W,b8 as X,S as Y,I as ee,z as P,as as se,r as d,aL as ae,m as re,H as te,N as le,J as ne,L as oe,F as ce}from"./index-CHtXOOwB.js";import{S as ie}from"./star-DhDyIT4N.js";import{C as de}from"./calendar-Ce1fAqbV.js";import{F as k}from"./folder-plus-ChE6HL0h.js";import{S as xe}from"./scroll-area-CvAawM1u.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=I("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),he=({project:s,onExportPDF:n,onExportCSV:c,onDelete:m})=>{const{profile:i}=B(),r=(i==null?void 0:i.subscription_tier)==="premium",t=s.premium_only||!1,h=!t||t&&r;return e.jsx(H,{className:`h-full ${t&&!r?"opacity-70 pointer-events-none":""}`,children:e.jsxs(V,{className:"p-6 flex flex-col h-full",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 max-w-[70%]",children:[t&&e.jsx(ie,{className:"h-4 w-4 text-yellow-500 flex-shrink-0"}),e.jsx(x,{to:h?`/projects/${s.id}`:"#",className:"font-medium text-lg hover:text-carbon-600 transition-colors line-clamp-1 text-left",onClick:l=>{h||(l.preventDefault(),alert("This is a premium project feature. Please upgrade to access."))},children:s.name})]}),h&&e.jsxs(O,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(o,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(G,{align:"end",className:"w-[200px] bg-background",children:[e.jsx(j,{asChild:!0,children:e.jsxs(x,{to:`/projects/${s.id}`,className:"flex items-center",children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"View & Edit"})]})}),e.jsxs(j,{onClick:n,children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Export as PDF"})]}),e.jsxs(j,{onClick:c,children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Export as CSV"})]}),e.jsxs(j,{onClick:m,className:"text-red-600",children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Delete"})]})]})]})]}),e.jsx("p",{className:"text-muted-foreground text-sm line-clamp-2 mb-3 flex-grow text-left",children:s.description||"No description provided."}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mb-2",children:[e.jsx(de,{className:"h-4 w-4 mr-1.5 flex-shrink-0"}),e.jsx("span",{children:new Date(s.updated_at).toLocaleDateString()})]}),s.result&&e.jsxs("div",{className:"bg-carbon-50 dark:bg-carbon-800 p-2 rounded-md flex justify-between items-center mb-3",children:[e.jsx("span",{className:"text-sm",children:"Total Emissions:"}),e.jsxs("span",{className:"font-medium",children:[Math.round(s.result.totalEmissions)," kg COâ‚‚e"]})]}),s.tags&&s.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-auto pt-2",children:[s.tags.slice(0,3).map(l=>e.jsx(p,{variant:"secondary",className:"text-xs",children:l},l)),s.tags.length>3&&e.jsxs(p,{variant:"outline",className:"text-xs",children:["+",s.tags.length-3," more"]})]}),t&&!r&&e.jsx("div",{className:"mt-3 bg-yellow-50 dark:bg-yellow-900/30 p-2 rounded text-xs text-yellow-800 dark:text-yellow-200 text-center",children:"Premium feature - Upgrade to access"})]})})},ue=({project:s,onClose:n,onConfirm:c})=>s?e.jsx(J,{open:!!s,onOpenChange:n,children:e.jsxs(Q,{className:"bg-background text-foreground border-border",children:[e.jsxs(Z,{children:[e.jsx(K,{children:"Delete Project"}),e.jsxs(W,{className:"text-muted-foreground",children:['Are you sure you want to delete "',s.name,'"? This action cannot be undone.']})]}),e.jsxs(X,{children:[e.jsx(o,{variant:"outline",onClick:n,className:"border-border",children:"Cancel"}),e.jsx(o,{variant:"destructive",onClick:c,children:"Delete"})]})]})}):null,je=({allTags:s,selectedTag:n,onTagChange:c,searchQuery:m,onSearchChange:i})=>e.jsxs("div",{className:"mb-6 flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ee,{placeholder:"Search projects...",className:"pl-9",value:m,onChange:r=>i(r.target.value)})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(p,{variant:n===null?"default":"outline",className:"cursor-pointer",onClick:()=>c(null),children:"All"}),s.map(r=>e.jsx(p,{variant:n===r?"default":"outline",className:"cursor-pointer",onClick:()=>c(r===n?null:r),children:r},r))]})]}),pe=({hasFilters:s})=>e.jsxs("div",{className:"text-center py-12 bg-white dark:bg-card rounded-lg shadow-sm",children:[e.jsx(y,{className:"mx-auto h-12 w-12 text-muted-foreground mb-3"}),e.jsx("h2",{className:"text-xl font-medium mb-1 text-foreground",children:"No projects found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:s?"Try adjusting your search or filters":"Start by creating your first carbon calculation"}),e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(o,{asChild:!0,variant:"outline",children:e.jsxs(x,{to:"/projects/new",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"New Project"]})}),e.jsx(o,{asChild:!0,className:"bg-carbon-600 hover:bg-carbon-700 text-white",children:e.jsxs(x,{to:"/calculator",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"New Calculation"]})})]})]}),ge=()=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:"My Projects"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your carbon footprint calculations"})]}),e.jsxs("div",{className:"mt-4 md:mt-0 space-x-2",children:[e.jsx(o,{asChild:!0,variant:"outline",children:e.jsxs(x,{to:"/projects/browse",children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Browse All"]})}),e.jsx(o,{asChild:!0,variant:"outline",children:e.jsxs(x,{to:"/projects/new",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"New Project"]})}),e.jsx(o,{asChild:!0,className:"bg-carbon-600 hover:bg-carbon-700 text-white",children:e.jsxs(x,{to:"/calculator",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"New Calculation"]})})]})]}),fe=9,ye=()=>{const{projects:s,deleteProject:n,exportProjectPDF:c,exportProjectCSV:m,isLoading:i,fetchError:r}=se(),[t,h]=d.useState(""),[l,D]=d.useState(null),[g,f]=d.useState(null);ae();const[N,w]=d.useState(1),[v,S]=d.useState([]),[E,M]=d.useState(!1),T=Array.from(new Set(s.flatMap(a=>a.tags||[]))),C=s.filter(a=>{const b=t===""||a.name.toLowerCase().includes(t.toLowerCase())||(a.description||"").toLowerCase().includes(t.toLowerCase()),u=l===null||(a.tags||[]).includes(l);return b&&u});d.useEffect(()=>{(t!==""||l!==null)&&w(1);const a=[...C].sort((_,A)=>new Date(A.updated_at).getTime()-new Date(_.updated_at).getTime()),b=0,u=N*fe;S(a.slice(b,u)),M(u<a.length)},[C,N,t,l]);const L=()=>{w(a=>a+1)},F=()=>{g&&(n(g.id),f(null))};return e.jsxs(re.div,{className:"min-h-screen flex flex-col bg-carbon-50 dark:bg-carbon-900 overflow-x-hidden",initial:{opacity:0},animate:{opacity:1},transition:{duration:.4},children:[e.jsxs(te,{children:[e.jsx("title",{children:"Projects | CarbonConstruct"}),e.jsx("meta",{name:"description",content:"View and manage all your carbon footprint calculation projects."})]}),e.jsx(le,{}),e.jsx("main",{className:"flex-grow pt-24 md:pt-28 px-4 pb-12 overflow-y-auto",children:e.jsx(xe,{className:"h-full w-full",children:e.jsxs("div",{className:"container mx-auto",children:[e.jsx(ge,{}),e.jsx(je,{allTags:T,selectedTag:l,onTagChange:D,searchQuery:t,onSearchChange:h}),e.jsx(ne,{feature:"Projects List",ignoreErrors:!0,children:i?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(oe,{className:"h-8 w-8 animate-spin text-carbon-600"}),e.jsx("span",{className:"ml-3 text-lg",children:"Loading your projects..."})]}):r?e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6 my-4 text-center",children:[e.jsx("p",{className:"text-red-700 dark:text-red-300 mb-3",children:r.message||"There was an error loading your projects."}),e.jsx(o,{variant:"outline",className:"border-red-300 text-red-700 hover:bg-red-100",onClick:()=>window.location.reload(),children:"Retry"})]}):v.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.map(a=>e.jsx(he,{project:a,onDelete:()=>f(a),onExportPDF:()=>c(a),onExportCSV:()=>m(a)},a.id))}),E&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsx(o,{onClick:L,variant:"outline",className:"border-carbon-300 dark:border-carbon-700",children:"Load More Projects"})})]}):e.jsx(pe,{hasFilters:!!t||l!==null})})]})})}),e.jsx(ce,{}),e.jsx(ue,{project:g,onClose:()=>f(null),onConfirm:F})]})};export{ye as default};
//# sourceMappingURL=UserProjects-DK9hkqlb.js.map
