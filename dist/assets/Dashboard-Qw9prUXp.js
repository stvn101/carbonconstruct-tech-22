import{w as ae,j as e,b as y,c as w,D as S,d as N,e as M,a1 as X,B as g,p as D,_ as z,E as te,O as K,ak as re,R as ne,g as q,a as se,a4 as W,f as ie,al as oe,r as b,ac as le,am as ce,an as de,ao as B,ap as A,aq as ue,ar as F,s as H,i as T,as as me,h as he,at as fe,N as xe,V as ve,W as ge,Y as E,Z as O}from"./index-CHtXOOwB.js";import{C as Z}from"./calendar-Ce1fAqbV.js";import{F as J}from"./folder-plus-ChE6HL0h.js";import{S as be}from"./shield-C3KNxYec.js";import{P as je}from"./PaymentSuccess-4yaU1Bvn.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=ae("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),pe=({projectsCount:a,recentProjects:t})=>{var r;return e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 mb-6",children:[e.jsxs(y,{children:[e.jsxs(w,{className:"pb-2",children:[e.jsx(S,{children:"Total Projects"}),e.jsx(N,{className:"text-3xl",children:a})]}),e.jsx(M,{className:"pt-0",children:e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center",children:[e.jsx(V,{className:"h-3 w-3 mr-1 text-green-500"}),e.jsx("span",{className:"text-green-500 font-medium",children:"+2"}),e.jsx("span",{className:"ml-1",children:"from last month"})]})})]}),e.jsxs(y,{children:[e.jsxs(w,{className:"pb-2",children:[e.jsx(S,{children:"Average Emissions"}),e.jsxs(N,{className:"text-3xl",children:["243 ",e.jsx("span",{className:"text-lg",children:"kg CO₂e"})]})]}),e.jsx(M,{className:"pt-0",children:e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center",children:[e.jsx(V,{className:"h-3 w-3 mr-1 text-green-500 rotate-180"}),e.jsx("span",{className:"text-green-500 font-medium",children:"-5%"}),e.jsx("span",{className:"ml-1",children:"reduction from baseline"})]})})]}),e.jsxs(y,{children:[e.jsxs(w,{className:"pb-2",children:[e.jsx(S,{children:"Latest Calculation"}),e.jsx(N,{className:"text-xl truncate",children:((r=t[0])==null?void 0:r.name)||"No projects yet"})]}),e.jsx(M,{className:"pt-0",children:e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center",children:[e.jsx(Z,{className:"h-3 w-3 mr-1"}),t[0]?new Date(t[0].updated_at).toLocaleDateString():"N/A"]})})]}),e.jsxs(y,{children:[e.jsxs(w,{className:"pb-2",children:[e.jsx(S,{children:"Optimization Potential"}),e.jsx(N,{className:"text-3xl",children:"18.5%"})]}),e.jsx(M,{className:"pt-0",children:e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center",children:[e.jsx(X,{className:"h-3 w-3 mr-1 text-blue-500"}),e.jsx("span",{children:"Based on latest AI analysis"})]})})]})]})},ye=({projects:a})=>e.jsxs(y,{children:[e.jsxs(w,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Recent Projects"}),e.jsx(S,{children:"Manage and view your recent carbon calculations"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{asChild:!0,variant:"outline",children:e.jsxs(D,{to:"/projects/new",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"New Project"]})}),e.jsx(g,{asChild:!0,className:"bg-carbon-600 hover:bg-carbon-700 text-white",children:e.jsxs(D,{to:"/projects",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"View All"]})})]})]}),e.jsx(M,{children:a.length>0?e.jsx("div",{className:"space-y-4",children:a.sort((t,r)=>new Date(r.updated_at).getTime()-new Date(t.updated_at).getTime()).slice(0,5).map(t=>e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center p-4 rounded-lg border hover:bg-carbon-50 dark:hover:bg-carbon-800",children:[e.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[e.jsx("div",{className:"bg-carbon-100 dark:bg-carbon-800 p-2 rounded-md mr-3",children:e.jsx(te,{className:"h-5 w-5 text-carbon-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:t.name}),e.jsxs("div",{className:"flex flex-wrap items-center text-xs text-muted-foreground gap-2 mt-1",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Z,{className:"h-3 w-3 mr-1"}),new Date(t.updated_at).toLocaleDateString()]}),t.result&&e.jsxs("span",{className:"flex items-center",children:[e.jsx(K,{className:"h-3 w-3 mr-1"}),Math.round(t.result.totalEmissions)," kg CO₂e"]})]})]})]}),e.jsx(g,{asChild:!0,variant:"outline",size:"sm",children:e.jsx(D,{to:`/projects/${t.id}`,children:"View Details"})})]},t.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(z,{className:"mx-auto h-12 w-12 text-muted-foreground mb-3"}),e.jsx("h3",{className:"font-medium mb-1",children:"No projects yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Start by creating your first carbon calculation"}),e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(g,{asChild:!0,variant:"outline",children:e.jsxs(D,{to:"/projects/new",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"New Project"]})}),e.jsx(g,{asChild:!0,className:"bg-carbon-600 hover:bg-carbon-700 text-white",children:e.jsxs(D,{to:"/calculator",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"New Calculation"]})})]})]})})]}),we=()=>e.jsxs(y,{children:[e.jsxs(w,{children:[e.jsx(N,{children:"Reports"}),e.jsx(S,{children:"Generate and view carbon footprint reports"})]}),e.jsx(M,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"bg-carbon-100 dark:bg-carbon-800 p-2 rounded-full",children:e.jsx(z,{className:"h-5 w-5 text-carbon-600"})}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Updated Weekly"})]}),e.jsx("h3",{className:"font-medium mb-1",children:"Project Summary"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Overview of all your project emissions"}),e.jsx(g,{variant:"outline",size:"sm",className:"w-full",children:"Generate Report"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"bg-carbon-100 dark:bg-carbon-800 p-2 rounded-full",children:e.jsx(ne,{className:"h-5 w-5 text-carbon-600"})}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Updated Monthly"})]}),e.jsx("h3",{className:"font-medium mb-1",children:"Emissions Analysis"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Detailed analysis of your carbon footprint"}),e.jsx(g,{variant:"outline",size:"sm",className:"w-full",children:"Generate Report"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"bg-carbon-100 dark:bg-carbon-800 p-2 rounded-full",children:e.jsx(K,{className:"h-5 w-5 text-carbon-600"})}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Updated Quarterly"})]}),e.jsx("h3",{className:"font-medium mb-1",children:"Sustainability Report"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Comprehensive sustainability assessment"}),e.jsx(g,{variant:"outline",size:"sm",className:"w-full",children:"Generate Report"})]})]})})]}),$=()=>{const{profile:a}=q(),t=se(),r=(a==null?void 0:a.subscription_tier)==="premium";return e.jsxs(y,{className:`w-full ${r?"border-green-500 dark:border-green-700":""}`,children:[e.jsx(w,{className:"flex flex-row items-center justify-between",children:e.jsxs(N,{className:"flex items-center",children:[e.jsx(be,{className:"mr-2 h-5 w-5"}),"Subscription Status",r&&e.jsx(W,{className:"ml-2 bg-green-600",children:"Premium"})]})}),e.jsxs(M,{children:[e.jsx("p",{className:"mb-4",children:r?"You're on a Premium plan with access to all features.":"You're currently on the Free plan with limited features."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Your access includes:"}),e.jsxs("ul",{className:"space-y-1 text-sm",children:[e.jsx("li",{children:"• Carbon footprint calculation"}),e.jsx("li",{children:"• Basic material database"}),r&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"• Extended materials library"}),e.jsx("li",{children:"• Advanced analytics"}),e.jsx("li",{children:"• Team collaboration"}),e.jsx("li",{children:"• Priority support"})]})]})]}),!r&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Upgrade to get:"}),e.jsxs("ul",{className:"space-y-1 text-sm opacity-70",children:[e.jsx("li",{children:"• Extended materials library"}),e.jsx("li",{children:"• Advanced analytics"}),e.jsx("li",{children:"• Team collaboration"}),e.jsx("li",{children:"• Priority support"})]})]})]})]}),e.jsx(ie,{children:r?e.jsx(g,{variant:"outline",className:"ml-auto",onClick:()=>t("/dashboard?tab=payments"),children:"View Payment History"}):e.jsxs(g,{onClick:()=>t("/pricing"),className:"ml-auto",children:["Upgrade Now ",e.jsx(V,{className:"ml-1 h-4 w-4"})]})})]})};function j(a,t){if(t.length<a)throw new TypeError(a+" argument"+(a>1?"s":"")+" required, but only "+t.length+" present")}function h(a){j(1,arguments);var t=Object.prototype.toString.call(a);return a instanceof Date||oe(a)==="object"&&t==="[object Date]"?new Date(a.getTime()):typeof a=="number"||t==="[object Number]"?new Date(a):((typeof a=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}var Ne={};function Me(){return Ne}function Q(a){var t=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()));return t.setUTCFullYear(a.getFullYear()),a.getTime()-t.getTime()}function _(a,t){j(2,arguments);var r=h(a),n=h(t),s=r.getTime()-n.getTime();return s<0?-1:s>0?1:s}function Pe(a,t){j(2,arguments);var r=h(a),n=h(t),s=r.getFullYear()-n.getFullYear(),l=r.getMonth()-n.getMonth();return s*12+l}function Te(a,t){return j(2,arguments),h(a).getTime()-h(t).getTime()}var Se={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)}},De="trunc";function Ce(a){return Se[De]}function ke(a){j(1,arguments);var t=h(a);return t.setHours(23,59,59,999),t}function We(a){j(1,arguments);var t=h(a),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Re(a){j(1,arguments);var t=h(a);return ke(t).getTime()===We(t).getTime()}function Ae(a,t){j(2,arguments);var r=h(a),n=h(t),s=_(r,n),l=Math.abs(Pe(r,n)),i;if(l<1)i=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-s*l);var u=_(r,n)===-s;Re(h(a))&&l===1&&_(a,n)===1&&(u=!1),i=s*(l-Number(u))}return i===0?0:i}function Fe(a,t,r){j(2,arguments);var n=Te(a,t)/1e3;return Ce()(n)}var Ee={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Oe=function(t,r,n){var s,l=Ee[t];return typeof l=="string"?s=l:r===1?s=l.one:s=l.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function Y(a){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width?String(t.width):a.defaultWidth,n=a.formats[r]||a.formats[a.defaultWidth];return n}}var _e={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Le={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Ye={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ie={date:Y({formats:_e,defaultWidth:"full"}),time:Y({formats:Le,defaultWidth:"full"}),dateTime:Y({formats:Ye,defaultWidth:"full"})},Xe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ze=function(t,r,n,s){return Xe[t]};function C(a){return function(t,r){var n=r!=null&&r.context?String(r.context):"standalone",s;if(n==="formatting"&&a.formattingValues){var l=a.defaultFormattingWidth||a.defaultWidth,i=r!=null&&r.width?String(r.width):l;s=a.formattingValues[i]||a.formattingValues[l]}else{var u=a.defaultWidth,o=r!=null&&r.width?String(r.width):a.defaultWidth;s=a.values[o]||a.values[u]}var d=a.argumentCallback?a.argumentCallback(t):t;return s[d]}}var He={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Ve={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},qe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Ue={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Be={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Je={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},$e=function(t,r){var n=Number(t),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Qe={ordinalNumber:$e,era:C({values:He,defaultWidth:"wide"}),quarter:C({values:Ve,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:C({values:qe,defaultWidth:"wide"}),day:C({values:Ue,defaultWidth:"wide"}),dayPeriod:C({values:Be,defaultWidth:"wide",formattingValues:Je,defaultFormattingWidth:"wide"})};function k(a){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,s=n&&a.matchPatterns[n]||a.matchPatterns[a.defaultMatchWidth],l=t.match(s);if(!l)return null;var i=l[0],u=n&&a.parsePatterns[n]||a.parsePatterns[a.defaultParseWidth],o=Array.isArray(u)?Ke(u,function(v){return v.test(i)}):Ge(u,function(v){return v.test(i)}),d;d=a.valueCallback?a.valueCallback(o):o,d=r.valueCallback?r.valueCallback(d):d;var x=t.slice(i.length);return{value:d,rest:x}}}function Ge(a,t){for(var r in a)if(a.hasOwnProperty(r)&&t(a[r]))return r}function Ke(a,t){for(var r=0;r<a.length;r++)if(t(a[r]))return r}function Ze(a){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.match(a.matchPattern);if(!n)return null;var s=n[0],l=t.match(a.parsePattern);if(!l)return null;var i=a.valueCallback?a.valueCallback(l[0]):l[0];i=r.valueCallback?r.valueCallback(i):i;var u=t.slice(s.length);return{value:i,rest:u}}}var ea=/^(\d+)(th|st|nd|rd)?/i,aa=/\d+/i,ta={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ra={any:[/^b/i,/^(a|c)/i]},na={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},sa={any:[/1/i,/2/i,/3/i,/4/i]},ia={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},oa={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},la={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ca={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},da={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},ua={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},ma={ordinalNumber:Ze({matchPattern:ea,parsePattern:aa,valueCallback:function(t){return parseInt(t,10)}}),era:k({matchPatterns:ta,defaultMatchWidth:"wide",parsePatterns:ra,defaultParseWidth:"any"}),quarter:k({matchPatterns:na,defaultMatchWidth:"wide",parsePatterns:sa,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:k({matchPatterns:ia,defaultMatchWidth:"wide",parsePatterns:oa,defaultParseWidth:"any"}),day:k({matchPatterns:la,defaultMatchWidth:"wide",parsePatterns:ca,defaultParseWidth:"any"}),dayPeriod:k({matchPatterns:da,defaultMatchWidth:"any",parsePatterns:ua,defaultParseWidth:"any"})},ha={code:"en-US",formatDistance:Oe,formatLong:Ie,formatRelative:ze,localize:Qe,match:ma,options:{weekStartsOn:0,firstWeekContainsDate:1}};function ee(a,t){if(a==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(a[r]=t[r]);return a}function fa(a){return ee({},a)}var G=1440,xa=2520,I=43200,va=86400;function ga(a,t,r){var n,s;j(2,arguments);var l=Me(),i=(n=(s=r==null?void 0:r.locale)!==null&&s!==void 0?s:l.locale)!==null&&n!==void 0?n:ha;if(!i.formatDistance)throw new RangeError("locale must contain formatDistance property");var u=_(a,t);if(isNaN(u))throw new RangeError("Invalid time value");var o=ee(fa(r),{addSuffix:!!(r!=null&&r.addSuffix),comparison:u}),d,x;u>0?(d=h(t),x=h(a)):(d=h(a),x=h(t));var v=Fe(x,d),p=(Q(x)-Q(d))/1e3,m=Math.round((v-p)/60),c;if(m<2)return r!=null&&r.includeSeconds?v<5?i.formatDistance("lessThanXSeconds",5,o):v<10?i.formatDistance("lessThanXSeconds",10,o):v<20?i.formatDistance("lessThanXSeconds",20,o):v<40?i.formatDistance("halfAMinute",0,o):v<60?i.formatDistance("lessThanXMinutes",1,o):i.formatDistance("xMinutes",1,o):m===0?i.formatDistance("lessThanXMinutes",1,o):i.formatDistance("xMinutes",m,o);if(m<45)return i.formatDistance("xMinutes",m,o);if(m<90)return i.formatDistance("aboutXHours",1,o);if(m<G){var f=Math.round(m/60);return i.formatDistance("aboutXHours",f,o)}else{if(m<xa)return i.formatDistance("xDays",1,o);if(m<I){var P=Math.round(m/G);return i.formatDistance("xDays",P,o)}else if(m<va)return c=Math.round(m/I),i.formatDistance("aboutXMonths",c,o)}if(c=Ae(x,d),c<12){var R=Math.round(m/I);return i.formatDistance("xMonths",R,o)}else{var U=c%12,L=Math.floor(c/12);return U<3?i.formatDistance("aboutXYears",L,o):U<9?i.formatDistance("overXYears",L,o):i.formatDistance("almostXYears",L+1,o)}}function ba(a,t){return j(1,arguments),ga(a,Date.now(),t)}const ja=()=>{const{user:a}=q(),[t,r]=b.useState([]),[n,s]=b.useState(!0),[l,i]=b.useState(null),[u,o]=b.useState(!1),d=b.useRef(null),x=async()=>{if(!a){s(!1);return}try{s(!0),i(null),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{s(!1),i("Request timed out. Please try again.")},15e3);const{data:c,error:f}=await H.from("payments").select("*").eq("user_id",a.id).order("created_at",{ascending:!1});if(d.current&&(clearTimeout(d.current),d.current=null),f)throw f;r(c||[])}catch(c){console.error("Error loading payments:",c),i(c.message||"Failed to load payment history"),T.error("Failed to load payment history")}finally{s(!1),d.current&&(clearTimeout(d.current),d.current=null)}},v=async()=>{var c;if(a)try{o(!0);const f=setTimeout(()=>{o(!1),T.error("Verification request timed out. Please try again later.")},15e3),{data:P,error:R}=await H.functions.invoke("verify-payment");if(clearTimeout(f),R)throw R;((c=P==null?void 0:P.updated_payments)==null?void 0:c.length)>0?(T.success(`${P.updated_payments.length} payment(s) updated`),x()):T.info("No payment updates available")}catch(f){console.error("Error verifying payments:",f),T.error("Failed to verify payments")}finally{o(!1)}};b.useEffect(()=>()=>{d.current&&clearTimeout(d.current)},[]),b.useEffect(()=>{x()},[a]);const p=c=>{switch(c){case"completed":return e.jsx(W,{className:"bg-green-500",children:"Completed"});case"pending":return e.jsx(W,{variant:"outline",className:"text-amber-500 border-amber-500",children:"Pending"});case"failed":return e.jsx(W,{variant:"destructive",children:"Failed"});default:return e.jsx(W,{variant:"secondary",children:c})}},m=c=>{try{return ba(new Date(c),{addSuffix:!0})}catch{return c}};return n&&!u?e.jsxs(y,{className:"w-full",children:[e.jsx(w,{children:e.jsx(N,{children:"Payment History"})}),e.jsxs(M,{children:[e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-carbon-600"}),e.jsx("span",{className:"ml-3",children:"Loading payment history..."})]}),e.jsx("div",{className:"flex justify-center mt-4",children:e.jsxs(g,{onClick:()=>{s(!1),x()},variant:"outline",size:"sm",children:[e.jsx(X,{className:"h-4 w-4 mr-2"})," Force Refresh"]})})]})]}):l?e.jsxs(y,{className:"w-full",children:[e.jsx(w,{children:e.jsx(N,{children:"Payment History"})}),e.jsx(M,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx(le,{className:"h-12 w-12 text-red-500 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Failed to load payment history"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:l}),e.jsx(g,{onClick:x,children:"Try Again"})]})})]}):e.jsxs(y,{className:"w-full",children:[e.jsxs(w,{className:"flex flex-row items-center justify-between",children:[e.jsx(N,{children:"Payment History"}),e.jsxs(g,{size:"sm",variant:"outline",onClick:v,disabled:u,children:[e.jsx(X,{className:`h-4 w-4 mr-2 ${u?"animate-spin":""}`}),u?"Refreshing...":"Refresh"]})]}),e.jsx(M,{children:t.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No payment records found."}):e.jsxs(ce,{children:[e.jsx(de,{children:e.jsxs(B,{children:[e.jsx(A,{children:"Date"}),e.jsx(A,{children:"Description"}),e.jsx(A,{children:"Amount"}),e.jsx(A,{children:"Status"})]})}),e.jsx(ue,{children:t.map(c=>e.jsxs(B,{children:[e.jsx(F,{className:"whitespace-nowrap",children:m(c.created_at)}),e.jsx(F,{children:c.description}),e.jsxs(F,{children:["$",c.amount.toFixed(2)]}),e.jsx(F,{children:p(c.status)})]},c.id))})]})})]})},Pa=()=>{const{user:a}=q(),{projects:t}=me();he();const[r]=fe(),[n,s]=b.useState("overview"),[l,i]=b.useState(!1),[u,o]=b.useState(null);b.useEffect(()=>{const p=r.get("tab");p&&["overview","projects","reports","payments"].includes(p)&&s(p),r.get("payment")==="success"&&(i(!0),a&&H.functions.invoke("verify-payment").catch(f=>console.error("Error verifying payment:",f)));const c=setTimeout(()=>{document.querySelectorAll(".animate-spin").forEach(f=>{f instanceof HTMLElement&&(f.classList.remove("animate-spin"),f.setAttribute("title","Loading timed out. Please refresh the page."))}),T.error("Some components are taking too long to load. You may need to refresh the page.",{duration:8e3})},2e4);return o(c),()=>{u&&clearTimeout(u)}},[r,a]);const d=p=>{s(p);const m=new URL(window.location.href);m.searchParams.set("tab",p),window.history.pushState({},"",m.toString())},x=(t==null?void 0:t.slice(0,5))||[],v=(t==null?void 0:t.length)||0;return e.jsxs(e.Fragment,{children:[e.jsx(xe,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl content-top-spacing pt-24",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Dashboard"}),l&&e.jsx("div",{className:"mb-8",children:e.jsx(je,{onClose:()=>i(!1)})}),e.jsxs(ve,{value:n,onValueChange:d,className:"space-y-6",children:[e.jsx(ge,{className:"w-full border-b bg-transparent p-0",children:e.jsxs("div",{className:"flex overflow-x-auto pb-2",children:[e.jsx(E,{value:"overview",className:"rounded-none border-b-2 border-transparent px-4 py-2 data-[state=active]:border-carbon-600 data-[state=active]:shadow-none","data-state":n==="overview"?"active":"inactive",children:"Overview"}),e.jsx(E,{value:"projects",className:"rounded-none border-b-2 border-transparent px-4 py-2 data-[state=active]:border-carbon-600 data-[state=active]:shadow-none","data-state":n==="projects"?"active":"inactive",children:"Recent Projects"}),e.jsx(E,{value:"reports",className:"rounded-none border-b-2 border-transparent px-4 py-2 data-[state=active]:border-carbon-600 data-[state=active]:shadow-none","data-state":n==="reports"?"active":"inactive",children:"Reports"}),e.jsx(E,{value:"payments",className:"rounded-none border-b-2 border-transparent px-4 py-2 data-[state=active]:border-carbon-600 data-[state=active]:shadow-none","data-state":n==="payments"?"active":"inactive",children:"Payments"})]})}),e.jsx(O,{value:"overview",className:"pt-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-8",children:[e.jsx(pe,{projectsCount:v,recentProjects:x}),e.jsx($,{})]})}),e.jsx(O,{value:"projects",className:"pt-4",children:e.jsx(ye,{projects:t||[]})}),e.jsx(O,{value:"reports",className:"pt-4",children:e.jsx(we,{})}),e.jsx(O,{value:"payments",className:"pt-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-8",children:[e.jsx($,{}),e.jsx(ja,{})]})})]})]})]})};export{Pa as default};
//# sourceMappingURL=Dashboard-Qw9prUXp.js.map
