{"version":3,"file":"ProjectDetail-DbwYB9GB.js","sources":["../../src/components/project/ProjectForm.tsx","../../src/pages/ProjectDetail.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { SavedProject } from '@/types/project';\r\n\r\ninterface ProjectFormProps {\r\n  initialData?: SavedProject;\r\n  onSubmit: (project: SavedProject) => void;\r\n  onDelete?: () => void;\r\n  isEditing?: boolean;\r\n}\r\n\r\n// Temporary stub component until project form is rebuilt\r\nconst ProjectForm: React.FC<ProjectFormProps> = ({ initialData, onSubmit, onDelete, isEditing }) => {\r\n  return (\r\n    <div className=\"p-8 text-center\">\r\n      <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-6\">\r\n        <h3 className=\"text-lg font-medium text-amber-800 mb-2\">Project Form Under Construction</h3>\r\n        <p className=\"text-amber-700 mb-4\">\r\n          The project form is being rebuilt with the new calculator system.\r\n        </p>\r\n        {initialData && (\r\n          <div className=\"text-left bg-white rounded p-4 mt-4\">\r\n            <h4 className=\"font-medium mb-2\">Current Project Data:</h4>\r\n            <pre className=\"text-sm text-gray-600 overflow-auto\">\r\n              {JSON.stringify(initialData, null, 2)}\r\n            </pre>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProjectForm;\r\n","\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { Helmet } from 'react-helmet-async';\r\nimport { motion } from 'framer-motion';\r\nimport { toast } from 'sonner';\r\nimport { fetchProjectById, updateProject as apiUpdateProject, deleteProject as apiDeleteProject } from '@/services/projectService';\r\nimport { SavedProject } from '@/types/project';\r\nimport Navbar from '@/components/navbar/Navbar';\r\nimport Footer from '@/components/Footer';\r\nimport ProjectForm from '@/components/project/ProjectForm';\r\nimport { useAuth } from '@/contexts/auth';\r\nimport { isOffline, showErrorToast } from '@/utils/errorHandling';\r\nimport { useProjects } from '@/contexts/ProjectContext';\r\n\r\nconst ProjectDetail: React.FC = () => {\r\n  const { projectId } = useParams<{ projectId: string }>();\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n  const { updateProject, deleteProject } = useProjects();\r\n  const [project, setProject] = useState<SavedProject | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState<Error | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!projectId) {\r\n      console.error(\"Project ID is missing.\");\r\n      navigate('/projects');\r\n      return;\r\n    }\r\n\r\n    const loadProject = async () => {\r\n      setIsLoading(true);\r\n      try {\r\n        const fetchedProject = await fetchProjectById(projectId);\r\n        if (fetchedProject) {\r\n          setProject(fetchedProject);\r\n        } else {\r\n          setError(new Error(\"Project not found\"));\r\n          toast.error(\"Project not found.\");\r\n          navigate('/projects');\r\n        }\r\n      } catch (err) {\r\n        setError(err instanceof Error ? err : new Error('Failed to load project'));\r\n        showErrorToast(\"Failed to load project. Please try again.\", \"project-load-error\");\r\n        navigate('/projects');\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    loadProject();\r\n  }, [projectId, navigate]);\r\n\r\n  const handleUpdate = async (updatedProject: SavedProject) => {\r\n    if (!user?.id || !projectId) {\r\n      console.error(\"User ID or Project ID is missing.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const projectData = {\r\n        ...updatedProject,\r\n        user_id: user.id,\r\n        id: projectId\r\n      };\r\n\r\n      const updated = await updateProject(projectData);\r\n\r\n      if (updated) {\r\n        toast.success(\"Project updated successfully!\");\r\n        setProject(updated);\r\n      } else {\r\n        toast.error(\"Failed to update project.\");\r\n      }\r\n    } catch (err) {\r\n      showErrorToast(\"Failed to update project. Please try again.\", \"project-update-error\");\r\n    }\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if (!projectId) {\r\n      console.error(\"Project ID is missing.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await deleteProject(projectId);\r\n      toast.success(\"Project deleted successfully!\");\r\n      navigate('/projects');\r\n    } catch (err) {\r\n      showErrorToast(\"Failed to delete project. Please try again.\", \"project-delete-error\");\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen flex flex-col\">\r\n        <Navbar />\r\n        <div className=\"flex-grow flex items-center justify-center\">\r\n          <div className=\"text-center\">\r\n            <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-carbon-600 mx-auto mb-4\"></div>\r\n            <p className=\"text-muted-foreground\">Loading project details...</p>\r\n          </div>\r\n        </div>\r\n        <Footer />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error || !project) {\r\n    return (\r\n      <div className=\"min-h-screen flex flex-col\">\r\n        <Navbar />\r\n        <div className=\"flex-grow flex items-center justify-center\">\r\n          <div className=\"text-center\">\r\n            <p className=\"text-red-600\">Error: {error?.message || 'Project not found'}</p>\r\n          </div>\r\n        </div>\r\n        <Footer />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex flex-col\">\r\n      <Helmet>\r\n        <title>Project Details | CarbonConstruct</title>\r\n        <meta \r\n          name=\"description\" \r\n          content=\"View and edit project details.\"\r\n        />\r\n      </Helmet>\r\n      <Navbar />\r\n      <main className=\"flex-grow container mx-auto px-4 py-8\">\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ duration: 0.4 }}\r\n        >\r\n          <div className=\"max-w-4xl mx-auto\">\r\n            <div className=\"mb-8\">\r\n              <h1 className=\"text-3xl font-bold mb-2\">Edit Project</h1>\r\n              <p className=\"text-muted-foreground\">\r\n                Update your project details and calculations.\r\n              </p>\r\n            </div>\r\n            \r\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6\">\r\n              <ProjectForm\r\n                initialData={project}\r\n                onSubmit={handleUpdate}\r\n                onDelete={handleDelete}\r\n                isEditing={true}\r\n              />\r\n            </div>\r\n          </div>\r\n        </motion.div>\r\n      </main>\r\n      <Footer />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProjectDetail;\r\n"],"names":["ProjectForm","initialData","onSubmit","onDelete","isEditing","jsxs","jsx","ProjectDetail","projectId","useParams","navigate","useNavigate","user","useAuth","updateProject","deleteProject","useProjects","project","setProject","useState","isLoading","setIsLoading","error","setError","useEffect","fetchedProject","fetchProjectById","toast","err","showErrorToast","handleUpdate","updatedProject","projectData","updated","handleDelete","Navbar","Footer","Helmet","motion"],"mappings":"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"}